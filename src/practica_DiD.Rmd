---
title: "Práctica: Diferencias en Diferencias"
author: 
  - Carlos Bautista
  - Mario Heredia
  - Mariana Lugo 
date: "`r Sys.Date()`"
output: pdf_document
header-includes: 
    - \usepackage{placeins}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

De acuerdo con el estudio de Card y Krueger (1994) analizaremos la relación entre un aumento del salario mínimo
y el empleo. Se cargan las librerías y datos utilizados en la práctica, además se muestra un ejemplo de los datos:

```{r, out.extra='FloatBarrier'}
library(tidyverse)
library(readr)
library(kableExtra)
library(dplyr)
library(stargazer)
library(car)

dta<- read.csv("/home/mariana/Documents/MCD/Diff_in_Diff_MCD/data/datadid.csv")
kable(head(dta), booktabs=TRUE) %>% 
  kable_styling(latex_options = c("scale_down","hold_position"))
```



## 1. ¿El efecto en el grupo de control es significativo antes de implementar la política?

Se especifica el primer modelo 1 (m1) como:

$$ Empleo_i= \beta_0+ \beta_1Tiempo + \beta_2Tratamiento + \beta_4TiempoTratamiento + u$$. En nuestros datos la variable que se refiere al tiempo es la denominada como *Treatmeant* y la variable que indica el grupo de tratamiento es la denominada como *Group*.

\newpage
```{r}
dta<-dta %>% mutate(DT=Treatment*Group)
m1 <- lm(Empl ~ Treatment + Group + DT , data = dta)

stargazer(m1, type="text")
```

El coeficiente de la regresión $\beta_0= 10.20513$ es el intercepto resultó significativo en el modelo 1. Por lo tanto, el valor promedio del número de empleados (variable de respuesta) es significativo en el grupo de control antes de aplicar el tratamiento (aumento del salario). 

```{r}
kable(m1$coefficients[1])
```
## 2. ¿Los grupos de tratamiento y de control muestran alguna diferencia significativa antes de implementar la política?

La diferencia entre el grupo de tratamiento y control antes de implementar la política se refiere al coeficiente $\beta_2$. En el modelo 1, el coeficiente $\beta_2$ resultó significativo por lo que la diferencia entre el número de empleados en Philadelphia (PA), como grupo de control, y New Jersey (NJ), como grupo de tratamiento, es sigfinicativa antes del aumento en el salario mínimo.

```{r}
kable(m1$coefficients[3])
```

## 3.¿En el grupo de tratamiento existe algún cambio significativo entre el primer y el segundo período de tiempo?

El cambio en el grupo de tratamiento del primer y segundo período está representado por $\beta_1 + \beta_3=0.7215565$. 

```{r}
b1_b3<-m1$coefficients[2]+m1$coefficients[4]
kable(b1_b3)

linearHypothesis(m1, c('Treatment + DT = 0'))

```
De acuerdo con el *p-value* del estadístico *F* no podemos rechazar la hipótesis nula. Es decir, no sabemos si el cambio antes y después del grupo de tratamiento es significativo. 


##. 4. Después del tratamiento ¿Hhy algún efecto significativo en el grupo de tratamiento sobre el de control? Es decir, ¿tiene impacto la política implementada?

```{r}
# b3
m1$coefficients[4]
```


## Comparar agregando una variable adicional

```{r}
m2 <- lm(Empl ~ Treatment + Group + Treatment*Group + SouthJ + CentralJ + NorthJ, data = dta)

summary(m2)
```
